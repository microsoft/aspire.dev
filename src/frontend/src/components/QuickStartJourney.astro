---
import { Icon } from '@astrojs/starlight/components';
import type { StarlightIcon } from '@astrojs/starlight/types';

interface Step {
  icon: StarlightIcon;
  title: string;
  description: string;
  href: string;
  label?: string;
}

interface Props {
  steps: Step[];
}

const { steps } = Astro.props;
---

<div class="journey not-content">
  <div class="journey-track" aria-hidden="true"></div>
  <ol class="journey-steps">
    {
      steps.map((step, i) => (
        <li class="journey-step">
          <div class="step-marker">
            <div class="step-icon-ring">
              <Icon name={step.icon} size="1.5rem" />
            </div>
          </div>
          <a href={step.href} class="step-content">
            <h3 class="step-title">{step.title}</h3>
            <p class="step-desc">{step.description}</p>
            <span class="step-link">
              {step.label ?? 'Learn more'}
              <Icon name="right-arrow" size="0.85rem" />
            </span>
          </a>
        </li>
      ))
    }
  </ol>
</div>

<style>
  .journey {
    position: relative;
    padding: 1.5rem 0 0.5rem;
  }

  .journey-track {
    position: absolute;
    left: 1.5rem;
    top: 2.5rem;
    bottom: 2rem;
    width: 3px;
    background: linear-gradient(
      180deg,
      color-mix(in srgb, var(--aspire-color-primary) 60%, transparent),
      color-mix(in srgb, var(--aspire-color-secondary) 40%, transparent),
      color-mix(in srgb, var(--aspire-color-muted) 20%, transparent)
    );
    border-radius: 1px;
  }

  .journey-steps {
    list-style: none;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    gap: 0;
  }

  .journey-step {
    display: grid;
    grid-template-columns: 3rem 1fr;
    gap: 1rem;
    padding: 1rem 0;
    position: relative;
  }

  .step-marker {
    display: flex;
    align-items: center;
    justify-content: center;
    padding-top: 0.75rem;
    position: relative;
    z-index: 1;
  }

  .step-icon-ring {
    width: 3rem;
    height: 3rem;
    border-radius: 50%;
    display: grid;
    place-items: center;
    background: color-mix(in srgb, var(--aspire-color-primary) 22%, var(--sl-color-bg));
    border: 2px solid color-mix(in srgb, var(--aspire-color-primary) 40%, var(--sl-color-bg));
    color: var(--aspire-color-primary);
    transition: all 0.25s ease;
  }

  .journey-step:hover .step-icon-ring {
    background: color-mix(in srgb, var(--aspire-color-primary) 32%, var(--sl-color-bg));
    border-color: var(--aspire-color-primary);
    transform: scale(1.06);
  }

  .step-content {
    display: block;
    text-decoration: none;
    padding: 0.75rem 1.25rem;
    border-radius: 0.75rem;
    border: 1px solid transparent;
    transition: all 0.25s ease;
    cursor: pointer;
  }

  .step-content:focus-visible {
    outline: 2px solid var(--sl-color-text);
    outline-offset: 2px;
  }

  .journey-step:hover .step-content {
    background: color-mix(in srgb, var(--aspire-color-primary) 6%, transparent);
    border-color: color-mix(in srgb, var(--aspire-color-primary) 18%, transparent);
  }

  .step-title {
    margin: 0 0 0.35rem;
    font-size: 1.05rem;
    font-weight: 600;
    color: var(--sl-color-text);
    line-height: 1.3;
  }

  .step-desc {
    margin: 0 0 0.65rem;
    font-size: 0.9rem;
    line-height: 1.55;
    color: var(--sl-color-gray-3);
  }

  :global([data-theme='light']) .step-desc {
    color: var(--sl-color-gray-2);
  }

  .step-link {
    display: inline-flex;
    align-items: center;
    gap: 0.35rem;
    font-size: 0.85rem;
    font-weight: 600;
    color: var(--aspire-color-secondary);
    text-decoration: none;
    transition: gap 0.2s ease;
  }

  :global([data-theme='light']) .step-link {
    color: var(--aspire-color-primary);
  }

  .step-content:hover .step-link {
    gap: 0.6rem;
    text-decoration: underline;
  }

  @media (max-width: 640px) {
    .journey-track {
      left: 1.25rem;
    }
    .journey-step {
      grid-template-columns: 2.5rem 1fr;
      gap: 0.75rem;
    }
    .step-icon-ring {
      width: 2.75rem;
      height: 2.75rem;
    }
  }

  @media (prefers-reduced-motion: reduce) {
    .step-icon-ring,
    .step-content,
    .step-link {
      transition: none;
    }
    .journey-step:hover .step-icon-ring {
      transform: none;
    }
  }
</style>
