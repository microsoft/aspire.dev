---
import type { StarlightIcon } from "@astrojs/starlight/types";

export interface Props {
    title: string;
    description: string;
    link: string;
    linkText?: string;
    icon?: StarlightIcon;
}

let { title, description, link, icon, linkText } = Astro.props as Props;

try {
    const url = new URL(link);
    if (url.hostname === "learn.microsoft.com") {
        if (!url.searchParams.has("WT.mc_id")) {
            url.searchParams.set("WT.mc_id", "aspire.dev");
        }
        link = url.toString();
    }
} catch {
    // Invalid URL; leave link unchanged.
}

import { LinkButton, Card } from "@astrojs/starlight/components";
---

<Card title={title} class:list="placeholder-card" icon={icon || "puzzle"}>
    <p>{description}</p>

    <LinkButton
        href={link}
        variant="secondary"
        icon="external"
        iconPlacement="end"
    >
        {
            linkText
                ? `Microsoft Learn: ${linkText} docs`
                : "Explore more on Microsoft Learn"
        }
    </LinkButton>
</Card>
